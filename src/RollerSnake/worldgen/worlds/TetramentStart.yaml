name: STRINGS.WORLDS.TETRAMENT.NAME
description: STRINGS.WORLDS.TETRAMENT.DESCRIPTION
asteroidIcon: asteroid_testdesert_kanim
nameTables: [ TERRA ]
# This asteroid is the DLC-specific Tetrament Cluster starting planetoid

worldTraitScale: 0.44
worldsize:
  X: 160
  Y: 274
layoutMethod: PowerTree

defaultsOverrides:
  startingWorldElements: []
  data:
    OverworldDensityMin: 18
    OverworldDensityMax: 18
    OverworldSampleBehaviour: PoissonDisk

subworldFiles:
  - name: subworlds/space/Space
  - name: subworlds/magma/Bottom
  - name: subworlds/jungle/Jungle
    minCount: 3
  - name: subworlds/testdesert/TestDesertStart
    overridePower: 4
  - name: subworlds/testdesert/TestDesertMiniMetal
    minCount: 1
  - name: subworlds/testdesert/TestDesertMiniLime
    minCount: 1
  - name: subworlds/testdesert/TestDesertMiniOxy
    minCount: 1
    maxCount: 1
  - name: subworlds/testdesert/TestDesertMiniAlgae
    minCount: 1
    maxCount: 1
  - name: expansion1::subworlds/barren/CoalyGranite
    overridePower: 1
  - name: expansion1::subworlds/wasteland/WastelandBeetle
    minCount: 3
  - name: expansion1::subworlds/wasteland/WastelandWorm
    minCount: 1
    maxCount: 2
  - name: expansion1::subworlds/frozen/FrozenSlush
    minCount: 3
  - name: subworlds/testdesert/TestDesertMed
    minCount: 2

startSubworldName: subworlds/testdesert/TestDesertStart
startingBaseTemplate: bases/desertStartingBase
startingBasePositionHorizontal:
  min: 0.45
  max: 0.55
startingBasePositionVertical:
  min: 0.42
  max: 0.48

worldTraitRules:
  - min: 0
    max: 2
    # Ban: large glaciers (too big), oil adding traits (redundant), subsurface ocean (too big), geodormant/geoactive (no effect), challenge (hard enough already!)
    forbiddenTags:
      - Surface
      - NonStartWorld
      - Oil
      - Wet
      - GenericGeysers
      - VeryCold
    # Magma channels and volcanoes (too big)
    forbiddenTraits:
      - traits/MagmaVents
      - expansion1::traits/Volcanoes

fixedTraits:
  - sunlightMed
  - cosmicRadiationVeryLow

unknownCellsAllowedSubworlds: 
  - tagcommand: DistanceFromTag
    tag: AtStart
    minDistance: 3
    maxDistance: 99
    command: Replace
    subworldNames:
      - subworlds/jungle/Jungle
      - subworlds/testdesert/TestDesertMed
  - tagcommand: DistanceFromTag
    tag: AtStart
    minDistance: 1
    maxDistance: 1
    command: Replace
    subworldNames:    
      - subworlds/testdesert/TestDesertMiniMetal
      - subworlds/testdesert/TestDesertMiniOxy
      - subworlds/testdesert/TestDesertMiniAlgae
      - subworlds/testdesert/TestDesertMiniLime
      - expansion1::subworlds/wasteland/WastelandBeetle
  - tagcommand: DistanceFromTag
    tag: AtStart
    minDistance: 2
    maxDistance: 2
    command: Replace
    subworldNames:    
      - subworlds/testdesert/TestDesertMed
      - expansion1::subworlds/wasteland/WastelandBeetle
      - expansion1::subworlds/wasteland/WastelandWorm
  - tagcommand: DistanceFromTag
    tag: AtDepths
    minDistance: 0
    maxDistance: 0
    command: Replace
    subworldNames:
      - subworlds/magma/Bottom
  - tagcommand: DistanceFromTag
    tag: AtDepths
    minDistance: 1
    maxDistance: 1
    command: Replace
    subworldNames:
      - expansion1::subworlds/barren/CoalyGranite
  - tagcommand: AtTag
    tag: AtSurface
    command: Replace
    subworldNames:
      - subworlds/space/Space
  - tagcommand: DistanceFromTag
    tag: AtSurface
    minDistance: 1
    maxDistance: 1
    command: Replace
    subworldNames:
      - subworlds/space/Space
  - tagcommand: DistanceFromTag
    tag: AtSurface
    minDistance: 2
    maxDistance: 2
    command: Replace
    subworldNames:
      - expansion1::subworlds/frozen/FrozenSlush

worldTemplateRules:
  # 1x CSV, we are not that mean
  - names:
      - poi/jungle/geyser_steam
    listRule: GuaranteeOne
    priority: 100
    allowedCellsFilter:
      - command: Replace
        subworldNames:
          - subworlds/jungle/Jungle
  # 1x natural gas vent
  - names:
      - poi/jungle/geyser_methane
    listRule: GuaranteeOne
    priority: 100
    allowedCellsFilter:
      - command: Replace
        subworldNames:
          - subworlds/jungle/Jungle
  # 1x liquid sulfur geyser
  - names:
      - expansion1::geysers/liquid_sulfur
    listRule: GuaranteeOne
    priority: 100
    allowedCellsFilter:
      - command: Replace
        zoneTypes: [Wasteland]
  # 2x minor volcano
  - names:
    - expansion1::poi/poi_geyser_magma
    - expansion1::poi/poi_geyser_magma_2
    listRule: TryAll
    priority: 50
    allowedCellsFilter:
      - command: Replace
        tagcommand: DistanceFromTag
        tag: AtDepths
        minDistance: 1
        maxDistance: 1
      - command: IntersectWith
        zoneTypes: [ Barren, MagmaCore ]
  # Gas geysers, water is hard to find!
  - names:
    - geysers/chlorine_gas
    - geysers/hot_po2
    - geysers/slimy_po2
    - geysers/methane
    - geysers/hot_hydrogen
    listRule: TryOne
    times: 2
    allowDuplicates: true
    priority: 50
    allowedCellsFilter:
      - command: Replace
        tagcommand: DistanceFromTag
        tag: AtStart
        minDistance: 2
        maxDistance: 10
      - command: ExceptWith
        zoneTypes: [ Space ]
      - command: ExceptWith
        tagcommand: AtTag
        tag: NoGlobalFeatureSpawning
  # Oil Well feature in the badlands layer
  - names:
      - poi/poi_testdesert_badlands_reservoir
    listRule: GuaranteeOne
    priority: 40
    allowedCellsFilter:
      - command: Replace
        subworldNames:
          - expansion1::subworlds/barren/CoalyGranite
  # Oil Well feature in a wasteland biome
  - names:
      - poi/poi_testdesert_wasteland_reservoir
    listRule: GuaranteeOne
    priority: 40
    allowedCellsFilter:
      - command: Replace
        subworldNames:
          - expansion1::subworlds/wasteland/WastelandBeetle
  # Gravitas
  - names:
    - expansion1::poi/warp/sender
    - expansion1::poi/warp/receiver
    - expansion1::poi/warp/teleporter
    listRule: GuaranteeAll
    priority: 90
    allowedCellsFilter:
      - command: Replace
        tagcommand: DistanceFromTag
        tag: AtStart
        minDistance: 1
        maxDistance: 2
      - command: IntersectWith
        zoneTypes: [ Sandstone, Wasteland, BoggyMarsh, ToxicJungle ]
      - command: ExceptWith
        tagcommand: AtTag
        tag: NoGravitasFeatures
  - names:
    - expansion1::poi/genericGravitas/poi_office
    listRule: GuaranteeAll
    priority: 90
    allowedCellsFilter:
      - command: Replace
        tagcommand: DistanceFromTag
        tag: AtStart
        minDistance: 2
        maxDistance: 99
      - command: ExceptWith
        tagcommand: AtTag
        tag: NoGravitasFeatures
      - command: ExceptWith
        tagcommand: DistanceFromTag
        tag: AtDepths
        minDistance: 0
        maxDistance: 2
      - command: ExceptWith
        tagcommand: DistanceFromTag
        tag: AtSurface
        minDistance: 0
        maxDistance: 2
  - names:
    - expansion1::poi/radioactive/uranium_geode1
    listRule: GuaranteeOne
    useRelaxedFiltering: true
    allowExtremeTemperatureOverlap: true
    priority: 200
    allowedCellsFilter:
      - command: Replace
        tagcommand: DistanceFromTag
        tag: AtStart
        minDistance: 1
        maxDistance: 1
